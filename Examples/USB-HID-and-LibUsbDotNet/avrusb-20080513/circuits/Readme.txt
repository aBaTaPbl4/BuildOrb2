СХЕМЫ, НАХОДЯЩИЕСЯ В ЭТОЙ ПАПКЕ
===============================
Поскольку USB требует уровней 3.3 V на сигнальных линиях D+ D-, однако сам интерфейс USB предоставляет питание 5 V, необходимо некоторое преобразование уровня напряжения для питания устройства. Есть несколько методов для такого преобразования, см. примеры схем и их описание ниже (схемы *.sch в формате программы EAGLE schematics).

with-vreg.png и with-vreg.sch:
  Эта схема использует регулятор с малым падением напряжения для понижения уровня напряжения до 3.3 V. Вы должны использовать ИМЕННО регулятор с малым падением напряжения, поскольку стандартные регуляторы типа LM317 требуют не менее 2 V для падения напряжения на них. Достоинство этого метода в использовании точных уровней напряжения, требуемых для USB, и устройстов также запитывается от стабилизированного источника. Если кабель USB не используется (коннектор напрямую припаян к PCB), Вы можете также убрать резисторы 68 Ohm. Недостаток в том, что Вам может понадобиться использовать другой чип, с напряжением питания 5 V. Проверьте Ваш чип, может ли он работать с нужной тактовой частотой на напряжении 3.3 V.

with-zener.png и with-zener.sch:
  Эта схема снижает уровни сигналов D+ и D- с помощью диодов Зенера (стабилитрон). Стабилитроны ДОЛЖНЫ быть маломощными, с малым током, чтобы подтягивающие резисторы на D- генерировали напряжение более 2.5 V (но менее 3.6 V). Достоинство этой схемы в простоте и в том, что микроконтроллер может питаться от 5 V (если пренебречь падением напряжения на кабеле). Недостаток в том, что некоторые стабилитроны имеют напряжение меньше, чем 3 V  при запитывании через 1k5 и нужен тщательный подбор компонентов. Дополнительно увеличивается потребление мощности во время передачи данных по USB, так как ток от лог. 1 микроконтроллера ограничивается только резисторами 68 Ohm. Стабилитроны могут искажать форму сигнала из за своей емкости.

with-series-diodes.png и with-series-diodes.sch:
  Это упрощенная, недорогая версия регулирования напряжения. Вместо использования специального регулятора напряжения подключены 2 кремниевых диода в прямом направлении (что дает грубое уменьшение напряжения на 1.4 V). Это дает примерно 3.6 V уровня, что практическ попадает в разрешенный диапазон. Большой недостаток в том, что напряжение питание устройства не стабилизировано и напряжение сильно зависит от потребляемой мощности. Это недопустимо для аналоговых схем.

tiny45-rc.png and tiny45-rc.sch (EAGLE schematics):
  Пример подключения 8-pin устройства с использованием внутреннего RC-генератора тактовой частоты. Здесь также используются последовательные диоды для ограничения напряжения, однако Вы можете выбрать и другой метод. Внимание - вы должны выбрать тактовую частоту 16.5 MHz, поскольку модуль PLL приемника рассчитан на эту частоту.


ОБЩИЕ ЗАМЕЧАНИЯ
===============
Все примеры используют для D+ аппаратное прерывание INT0, так так оно имеет наивысший приоритет для микроконтроллеров AVR. Вы можете использовать другие аппаратные прерывания (и сконфигурировать соответственно опции в конце usbconfig.h), если Вы уверены, что нигде не используется прерывание с более высоким приоритетом.

Большинство примеров имеют 1M снижающий (pull-down) резистор на D+. Это обеспечивает отсутсвие генерации прерывания, когда USB не подсоединен и устройство питается от отдельного источника. Можно убрать этот резистор в случае питания от шины USB. Старые примеры имели вместо этого подтягивающий к + резистор (pull-up). Это не совместимо со стабилитронами по преобразованию уровней: 1M pull-up совместно с 3.6 V стабилитроном выдает неверный логический уровень.

Все примеры с ATMega8/88/168 имеют D+ на порте D bit 2 (поскольку это hardware interrupt 0) и D- на порте D bit 4 поскольку он также вход для тактов timer/counter 0. Этот метод дает для firmware простую проверку easily check активности на D- (импульсы USB frame) путем проверки (через регуляные интервалы времени) величины, записанной в счетчике. Если не обнаружено активности, firmware должно в соостветствии со спецификацией USB перевести систему в режим low power suspend.


Замечания переводчика
=====================
На мой взгляд, лучше всего использовать схему with-zener.png (with-zener.sch), исключив из неё стабилитроны, поскольку обычно и без них схема работает нормально. При этом получаем все преимущества - простая схема, минимум деталей, можно использовать полное напряжение 5 вольт шины USB, потери мощности на элементах стабилизации исключены. В крайнем случае стабилитроны можно установить, если что-то пойдет не так. Из отечественных стабилитронов нет таких, которые стабилизируют на напряжении 3.6 вольт, поэтому можно поставить КС133 (3.3 вольт) или КС139 (3.9 вольт). 

----------------------------------------------------------------------------
(c) 2008 by OBJECTIVE DEVELOPMENT Software GmbH.
http://www.obdev.at/
Перевод http://microsin.ru/
