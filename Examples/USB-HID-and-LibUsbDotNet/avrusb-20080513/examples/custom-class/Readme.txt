Пример custom-class, здесь мы покажем как можно управлять светодиодом LED через USB.


ЧТО ЗДЕСЬ ДЕМОНСТРИРУЕТСЯ?
==========================
Показывается, как малая порция данных (несколько байт) может быть переданамежду устройстовм и хостом. Дополнительно к очень простому USB устройству, это демонстрирует как построить приложение драйвера хоста с использованием libusb или libusb-win32. Это НЕ показывает, как используются функции usbFunctionWrite() и usbFunctionRead(). См. пример hid-data, если Вы хотите узнать больше об этих функциях.


ПРЕДВАРИТЕЛЬНЫЕ ТРЕБОВАНИЯ
==========================
Целевое железо (target hardware): Вам нужна схема AVR, основанная на примерах каталога circuits, например metaboard (http://www.obdev.at/goto.php?t=metaboard).

Среда разработки AVR: набор утилит gcc tool для AVR, см. корневой файл Readme.

Среда разработки для хоста: компилятор C и libusb. см. корневой файл Readme.


СБОРКА FIRMWARE
===============
Перейдите в папку "firmware" и измените Makefile в соответствии с Вашей архитектурой (частота CPU, тип устройства [микроконтроллера], значения fuse) и программатором ISP. Редактируйте usbconfig.h в соответствии с назначением ножек D+ и D-. Значения по умолчанию соответствуют плате metaboard. Вы должны подсоединить LED с токоограничивающим резистором current 270 Ohm на свободную ножку порта I/O. Измените настройку в main.c для соответствия нужному порту и номеру бита.

Введите "make hex" для сборки main.hex, затем "make flash" для загрузки firmware в устройство. Не забудьте ввести "make fuse" для однократного программирования значений перемычек fuse. Если Вы используете макетную плату с загрузчиком (boot loader), вместо этого используйте указания инструкции к загрузчику.

Пожалуйста обратите внимание, что первый "make hex" копирует драйвер из корня в папку firmware. Если Вы используете другую систему сборки (не Makefile), Вы должны скопировать драйвер вручную.


СБОРКА ПО ХОСТА
===============
Поскольку ПО хоста основано на libusb или libusb-win32, проверьте, что эта библиотека установлена. На Unix проверьте нахождение libusb-config в путях поиска запуска (search PATH). На Windows отредактируйте Makefile.windows и установите путь к библиотеке library в соответствии. Затем введите "make" на Unix или "make -f Makefile.windows" на Windows для сборки утилиты командной строки.


ИСПОЛЬЗОВАНИЕ УТИЛИТЫ КОМАНДНОЙ СТРОКИ
======================================
Утилита командной строки имеет 3 допустимых аргумента: "status" для запроса текущего состояния LED, "on" для включения LED и "off" для его выключения.


----------------------------------------------------------------------------
(c) 2008 by OBJECTIVE DEVELOPMENT Software GmbH.
http://www.obdev.at/
Перевод http://microsin.ru/
